import '@test/mock-fetch-options'
import { badResponseCodes } from '@test/utils'
import { describe, expect, test } from 'vitest'
import { getComponentConfig } from './get-component-config'

describe('getComponentConfig should handle response status codes from GET components/:id/configs endpoint', () => {
  const orgId = 'test-id'
  const componentId = 'test-id'
  const componentConfigId = 'test-id'
  /*
    @FIXME: @nnnnat
    getComponentConfig filters on config ID which is dynamically generated by faker
    and will never be the same as the provided config ID
    therefor the returned spec will always null

    @TODO: add get component config by id path to rest api
  */
  test('200 status', async () => {
    const spec = await getComponentConfig({
      componentId,
      componentConfigId,
      orgId,
    })
    expect(spec).toBeUndefined()
    // expect(spec).toHaveProperty('id')
    // expect(spec).toHaveProperty('version')
  })

  test.each(badResponseCodes)('%s status', async () => {
    await getComponentConfig({ componentId, componentConfigId, orgId }).catch(
      (err) => expect(err).toMatchSnapshot()
    )
  })
})