import '@test/mock-fetch-options'
import { expect, test } from 'vitest'
import { getInstallComponent } from './get-install-component'

const installComponentId = 'install-component-id'
const installId = 'install-id'
const orgId = 'org-id'

test('getInstallComponent should return a install component object', async () => {
  const spec = await getInstallComponent({
    installComponentId,
    installId,
    orgId,
  })

  /*
    @FIXME: @nnnnat
    getInstallComponent filters on install component ID which is dynamically generated by faker
    and will never be the same as the provided install component ID
    therefor the returned spec will always null

    @TODO: add get install component by run id path to rest api
  */
  expect(spec).toBeUndefined()
})

test('getInstallComponent should throw an error when it can not find a install component', async () => {
  try {
    await getInstallComponent({
      installComponentId,
      installId,
      orgId,
    })
  } catch (error) {
    expect(error).toMatchInlineSnapshot(
      `[Error: Failed to fetch install component]`
    )
  }
})
