import '@test/mock-fetch-options'
import { expect, test } from 'vitest'
import { getSandboxRun } from './get-sandbox-run'

const runId = 'run-id'
const installId = 'install-id'
const orgId = 'org-id'

test('getSandboxRun should return a sandbox run object', async () => {
  const spec = await getSandboxRun({
    runId,
    installId,
    orgId,
  })

  /*
    @FIXME: @nnnnat
    getSandboxRun filters on run ID which is dynamically generated by faker
    and will never be the same as the provided run ID
    therefor the returned spec will always null

    @TODO: add get sandbox run by run id path to rest api
  */
  expect(spec).toBeUndefined()
})

test('getSandboxRun should throw an error when it can not find a sandbox run', async () => {
  try {
    await getSandboxRun({
      runId,
      installId,
      orgId,
    })
  } catch (error) {
    expect(error).toMatchInlineSnapshot(`[Error: Failed to fetch sandbox run]`)
  }
})
