---
title: 'Docker Build Components'
description: "Docker build  components allow you to connect a Dockerfile that will be used to build a container image."
---

Docker build components allow you to build an existing `Dockerfile` in a public or connected repo, and sync it into your
customer installs. Please refer to the [Terraform
reference](https://registry.terraform.io/providers/nuonco/nuon/latest/docs/resources/docker_build_component) for full configuration
options.


## Configuring a Docker build component

To configure a Docker build component, specify a repo, the required build paramaters and Dockerfile path.

<CodeGroup>
```toml TOML
[[components]]
name       = "app_image"
type       = "docker_build"
dockerfile = "Dockerfile"
[components.connected_repo]
directory = "components/app-image"
repo      = "<your-app>"
branch    = "main"
```

```hcl Terraform
resource "nuon_docker_build_component" "e2e" {
  name       = "app_image"
  app_id     = nuon_app.<your-app>.id
  dockerfile = "Dockerfile"

  connected_repo = {
    directory = "components/app-image"
    repo      = "<your-app>"
    branch    = "main"
  }
}
```
</CodeGroup>

You can configure Docker build components to use either a public repo (using a `public_repo` block) or a private GitHub
repo (using a `connected_repo` block). Read more about VCS configuration [here](/guides/vcs).

## Deployments

Docker build components _cannot_ be deployed directly in a customer install. When an image is released, it will be _synced_
into the customer install and made available to other components via [variables](/guides/using-variables).

To deploy a Docker build component, reference the image from a Helm component, Terraform component or Job component:

<CodeGroup>
```toml TOML
[[components]]
name       = "eks_deployment"
type       = "helm_chart"
chart_name = "<your-app>"
[components.connected_repo]
repo      = "<your-app>"
directory = "components/helm-chart"
branch    = "main"
[components.values]
"env.IMAGE_TAG"        = "{{.nuon.components.app_image.image.tag}}"
"env.IMAGE_REPOSITORY" = "{{.nuon.components.app_image.image.repository.uri}}"

[[components]]
name              = "ecs_service"
type              = "terraform_module"
terraform_version = "v1.6.3"
[components.connected_repo]
repo      = "<your-app>"
directory = "components/ecs-service"
branch    = "main"
[components.vars]
"image_tag"        = "{{.nuon.components.app_image.image.tag}}"
"image_repository" = "{{.nuon.components.app_image.image.repository.uri}}"

[[components]]
name      = "eks_job"
type      = "job"
image_url = "{{.nuon.components.app_image.image.repository.uri}}"
tag       = "{{.nuon.components.app_image.image.tag}}"
```

```hcl Terraform
resource "nuon_helm_chart_component" "eks_deployment" {
  name       = "eks_deployment"
  app_id     = nuon_app.<your-app>.id
  chart_name = "<your-app>"

  connected_repo {
    repo      = "<your-app>"
    directory = "components/helm-chart"
    branch    = "main"
  }

  value {
    name  = "env.IMAGE_TAG"
    value = "{{.nuon.components.app_image.image.tag}}"
  }
  value {
    name  = "env.IMAGE_REPOSITORY"
    value = "{{.nuon.components.app_image.image.repository.uri}}"
  }
}

resource "nuon_terraform_component" "ecs_service" {
  name              = "ecs_service"
  app_id            = nuon_app.<your-app>.id
  terraform_version = "v1.6.3"

  connected_repo {
    repo      = "<your-app>"
    directory = "components/ecs-service"
    branch    = "main"
  }

  var {
    name  = "image_tag"
    value = "{{.nuon.components.app_image.image.tag}}"
  }

  value {
    name  = "image_repository"
    value = "{{.nuon.components.app_image.image.repository.uri}}"
  }
}

resource "nuon_job_component" "eks_job" {
  name      = "eks_job"
  app_id    = nuon_app.<your-app>.id
  image_url = "{{.nuon.components.app_image.image.repository.uri}}"
  tag       = "{{.nuon.components.app_image.image.tag}}"
}
```
</CodeGroup>

## Image Syncing

When a Docker build component is released, Nuon will automatically sync the image into the end customer account. This
image is stored in a local registry that is provisioned in the customer account.

Nuon image syncing allows you to sync images into accounts, without worrying about cross account permissions, registry
authentication or publishing public images. Any `Dockerfile` in a repo can be built, and synced.

The sync process works by creating a 1-time authentication flow that grants the install runner access to pull the image
from the org data plane, and copy it into the local registry.

## Build Arguments and Environment Variables

You can specify custom build arguments and environment variables to be used when building an image:

<Note>
If you have custom build requirements, we recommend building your images from within your own CI/CD platform, and using
  a [container image](/guides/container-image-components.mdx) to import them.
</Note>
